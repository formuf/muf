&НаСервере
Процедура ЭкспортДанныхНаСервере(ИмяФайла)
РЕКВИЗИТ = Метаданные.Справочники.СПРАВОЧНИК.СтандартныеРеквизиты.РЕКВИЗИТ.Представление();
РЕКВИЗИТ = Метаданные.Справочники.СПРАВОЧНИК.СтандартныеРеквизиты.РЕКВИЗИТ.Представление();
РЕКВИЗИТ = Метаданные.Справочники.СПРАВОЧНИК.Реквизиты.РЕКВИЗИТ.Представление();
Текст = новый ЗаписьТекста(ИмяФайла);
Выборка = Справочники.СПРАВОЧНИК.Выбрать();
Текст.ЗаписатьСтроку("РЕКВИЗИТ"+";"+ "РЕКВИЗИТ"+";"+ "РЕКВИЗИТ");
Пока Выборка.Следующий() Цикл
Текст.ЗаписатьСтроку (Выборка.РЕКВИЗИТ + ";" + Выборка.РЕКВИЗИТ +";"+ Выборка.РЕКВИЗИТ);
КонецЦикла;
Сообщить("Экспортирование файла .csv выполнено!");
Текст.Закрыть();
КонецПроцедуры

&НаКлиенте
Процедура Экспортирование(Команда)
ДиалогВыбора = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
ДиалогВыбора.Заголовок = "Выберите .csv файл";
ДиалогВыбора.Показать(Новый ОписаниеОповещения("ЭкспортированиеЗавершение", ЭтотОбъект, Новый Структура("ДиалогВыбора", ДиалогВыбора)));

КонецПроцедуры

&НаКлиенте
Процедура ЭкспортированиеЗавершение(ВыбранныеФайлы, ДополнительныеПараметры) Экспорт
	
	ДиалогВыбора = ДополнительныеПараметры.ДиалогВыбора;
	
	
	Если (ВыбранныеФайлы <> Неопределено) Тогда
		ИмяФайла = ДиалогВыбора.ПолноеИмяФайла;
	КонецЕсли;
	ЭкспортДанныхНаСервере(ИмяФайла);
	
КонецПроцедуры

&НаСервере
Процедура ИмпортДанныхНаСервере(ИмяФайла)
Текст = Новый ТекстовыйДокумент();
Текст.Прочитать(ИмяФайла);

КоличествоСтрок = Текст.КоличествоСтрок();

Для Счетчик = 2 по КоличествоСтрок Цикл
ТекСтрока = Текст.ПолучитьСтроку(Счетчик);
МассивСтр = СтрРазделить(ТекСтрока,";");
СПРАВОЧНИК = Справочники.СПРАВОЧНИК.СоздатьЭлемент();
СПРАВОЧНИК.РЕКВИЗИТ = МассивСтр[0];
СПРАВОЧНИК.РЕКВИЗИТ = МассивСтр[1];
СПРАВОЧНИК.РЕКВИЗИТ = МассивСтр[2];
СПРАВОЧНИК.Записать();
КонецЦикла;
Сообщить ("Импортирование файла .csv выполнено!");
КонецПроцедуры

&НаКлиенте
Процедура Импортирование(Команда)
ДиалогВыбора = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);

ДиалогВыбора.Заголовок = "Выберите .csv файл";

ДиалогВыбора.Показать(Новый ОписаниеОповещения("ИмпортированиеЗавершение", ЭтотОбъект, Новый Структура("ДиалогВыбора", ДиалогВыбора)));

КонецПроцедуры

&НаКлиенте
Процедура ИмпортированиеЗавершение(ВыбранныеФайлы, ДополнительныеПараметры) Экспорт
	
	ДиалогВыбора = ДополнительныеПараметры.ДиалогВыбора;
	
	
	Если (ВыбранныеФайлы <> Неопределено) Тогда
		
		ИмяФайла = ДиалогВыбора.ПолноеИмяФайла;
	КонецЕсли;
	ИмпортДанныхНаСервере(ИмяФайла)
	
КонецПроцедуры